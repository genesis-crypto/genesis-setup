name: Extract Content

on: 
  issues:
    types: [opened, reopened]

jobs:
  extract-content:
    runs-on: ubuntu-latest
    steps:
    - name: Extracting content
      run: |
        issue_body=$(echo "${{ github.event.issue.body }}" | jq -r .issue.body)
        repository=$(echo "$issue_body" | grep -oP '\[Repository\].*?(\S+)' | cut -d ' ' -f2)
        template=$(echo "$issue_body" | grep -oP '\[Template\].*?(\S+)' | cut -d ' ' -f2)
        echo "Repository: $repository"
        echo "Template: $template"
        echo "::set-output name=repository::$repository"
        echo "::set-output name=template::$template"

    - name: Save output to cache
      id: save-on-cache
      uses: actions/cache@v2
      with:
        path: outputs
        key: ${{ runner.os }}-extract-content-${{ hashFiles('outputs/repository outputs/template') }}
        restore-keys: |
          ${{ runner.os }}-extract-content-