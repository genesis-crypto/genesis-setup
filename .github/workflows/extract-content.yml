name: Extract Content

on: 
  issues:
    types: [opened, reopened]

jobs:
  extract-content:
    runs-on: ubuntu-latest
    steps:
      - name: Extract values
        id: extract
        run: |
          REPOSITORY=$(echo "${{ github.event.issue.body }}" | grep -Eo '### \[Repository\].*genesis-setup' | awk 'NF>1{print $NF}')
          TEMPLATE=$(echo "${{ github.event.issue.body }}" | grep -Eo '### \[Template\].*genesis-template-node' | awk 'NF>1{print $NF}')
          echo ::set-env name=REPOSITORY::$REPOSITORY
          echo ::set-env name=TEMPLATE::$TEMPLATE

      - name: Save to cache
        uses: actions/cache@v2
        with:
          path: |
            ${{ env.REPOSITORY }}/${{ env.TEMPLATE }}
          key: |
            ${{ env.REPOSITORY }}-${{ env.TEMPLATE }}-v1
          restore-keys: |
            ${{ env.REPOSITORY }}-${{ env.TEMPLATE }}-v1
